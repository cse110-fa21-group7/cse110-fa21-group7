<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js/read-recipe.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="RecipeCard.html">RecipeCard</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RecipeCard.html#setID">setID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RecipeCard.html#setID">setID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RecipeCard.html#setPage">setPage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RecipeCard.html#setPage">setPage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RecipeCard.html#setRecipes">setRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="RecipeCard.html#setRecipes">setRecipes</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addCurated">addCurated</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addList">addList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addSortListener">addSortListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addToCookbook">addToCookbook</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#asapInit">asapInit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#checkID">checkID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#checkValid">checkValid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#clearRecipeCards">clearRecipeCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#dictToArr">dictToArr</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#fetchFullRecipe">fetchFullRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#fetchRecipes">fetchRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#file">file</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getPage">getPage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hasFloat">hasFloat</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hasValue">hasValue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#init">init</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#makePage">makePage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateForm">populateForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateHTML">populateHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#recipeCards">recipeCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#removeTags">removeTags</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#searchbtn">searchbtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#showError">showError</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#showMessage">showMessage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#showSuccess">showSuccess</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#sortRecipes">sortRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#spoonToASAP">spoonToASAP</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#sum">sum</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#toReadRecipe">toReadRecipe</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">js/read-recipe.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// read-recipe.js
import { asapInit } from "./init.js";
let recipeObject;
let recipeID;
let userRecipe;
window.addEventListener("DOMContentLoaded", init);
const editButton = document.getElementById("Edit");
const deleteButton = document.getElementById("Delete");

/** Initialize function, begins all of the JS code in this file */
async function init() {
  await asapInit();
  userRecipe = JSON.parse(localStorage.getItem("userRecipes"));
  getPage();
  populateHTML();
}

/**
 * Checks if ID is in localStorage,return it back
 */
function getPage() {
  const url = window.location.href;
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);
  // default is reading cookbook
  if (url.includes("bookID")) {
    recipeObject = userRecipe;
  }
  if (url.includes("fetchID")) {
    editButton.innerHTML = "add";
    deleteButton.style.display = "none";
    recipeObject = JSON.parse(localStorage.getItem("storedRecipes"));
  }
  const id = urlParams.get("id");
  if (id) recipeID = id;
  else console.error("open recipe page incorrectly!!");
}

/** Populate forms by ID
 * @param {int} id
 */
function populateHTML() {
  const recipe = recipeObject[recipeID];
  console.log(`Recipe: ${recipe["title"]}`);
  // get article element, so we can append elements
  // const article = document.getElementById("recipeTitle");

  // add title
  document.getElementById("recipe-title").innerText = recipe["title"];
  // add Description
  document.getElementById("recipe-desc").innerText = recipe["description"];
  // add time
  const timeSpan = document.getElementById("time");
  if ("time" in recipe) {
    timeSpan.innerText = recipe["time"] + " minutes";
  } else {
    timeSpan.innerText = "Ready before you know it";
  }
  // add severings
  const servingSpan = document.getElementById("servings");
  if ("servings" in recipe) {
    servingSpan.innerText = `Servings: ${recipe["servings"]}`;
  } else {
    servingSpan.innerText = "Servings: 1";
  }
  // add cost
  const costSpan = document.getElementById("cost");
  if ("totalCost" in recipe) {
    // appends dollar sign and either does division to get cents -> dollars if spoonacular or just appends price
    costSpan.innerText = `Cost: $${recipe["totalCost"]}`;
  } else {
    costSpan.innerText = "Cost: Bout tree fiddy";
  }
  // add image
  const img = document.getElementById("recipeImg");

  const url = recipe["image"];
  if (!("image" in recipe)) {
    // No image uploaded, set default
    img.src = "../img/default.png";
  } else if (url.includes("https://i.imgur.com")) {
    // Tell imgur to resize image to medium (max 320x320) in case of large src image
    // Saves bandwidth
    const imgUrl = recipe["image"].split(".");
    imgUrl[imgUrl.length - 2] = imgUrl.at(-2) + "m";
    const imgUrlM = imgUrl.join(".");
    img.src = imgUrlM;
  } else {
    // Old img.src code
    img.src = url;
  }
  const ingList = document.getElementById("ingredient-list");
  for (const ingredient of recipe["ingredients"]) {
    const eachIng = document.createElement("li");
    eachIng.innerText = `${ingredient["name"]} ${ingredient["amount"]}`;
    ingList.appendChild(eachIng);
  }

  // add step list
  const stepList = document.getElementById("step-list");
  for (const step of recipe["steps"]) {
    const eachStep = document.createElement("li");
    eachStep.innerText = step;
    stepList.appendChild(eachStep);
  }
}
/** Sets event listeners */
editButton.addEventListener("click", () => {
  if (editButton.innerHTML === "add") {
    // add current recipe to cook book

    userRecipe[recipeID] = recipeObject[recipeID];
    localStorage.setItem("userRecipes", JSON.stringify(userRecipe));
    modalAdd.classList.add("active");
    const addConfirm = document.querySelector("#add-confirm");
    addConfirm.addEventListener("click", () => {
      modalAdd.classList.remove("active");
      window.location.replace(`/read/bookID?id=${recipeID}`);
    });
  } else {
    location.href = `/update?id=${recipeID}`;
  }
});
const closeModalButtons = document.querySelectorAll(".close-button");
closeModalButtons.forEach((button) => {
  button.addEventListener("click", () => {
    modal.classList.remove("active");
  });
});

deleteButton.addEventListener("click", (e) => {
  // Display pop-up boxes
  modal.classList.add("active");
  const closeBtn = document.querySelector("#close-button");
  closeBtn.addEventListener("click", () => {
    modal.classList.remove("active");
  });
  const confirmBtn = document.querySelector("#confirm-button");
  confirmBtn.addEventListener("click", () => {
    modal.classList.remove("active");
    delete recipeObject[recipeID];
    localStorage.setItem("userRecipes", JSON.stringify(recipeObject));
    location.href = "/cookbook";
  });
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Tue Dec 07 2021 05:32:17 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
